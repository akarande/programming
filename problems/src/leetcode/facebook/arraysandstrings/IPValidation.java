package leetcode.facebook.arraysandstrings;

public class IPValidation {
    public String validIPAddress(String queryIP) {
        if (queryIP.endsWith(".") || queryIP.endsWith(":") || queryIP.startsWith(".") || queryIP.startsWith(":")) return "Neither";
        return isIPv4(queryIP) ? "IPv4" : (isIPv6(queryIP) ? "IPv6" : "Neither");
    }

    boolean isIPv4(String str) {
        if (str.contains(":")) return false;
        String arr[] = str.split("\\.");
        if (arr.length != 4) return false;
        for (int i = 0; i < arr.length; i++) {
            if (arr[i].length() > 0 && arr[i].length() < 4 && isNumber(arr[i])) {
                if(arr[i].startsWith("0") && arr[i].length() == 1) return false;
                int value = Integer.valueOf(arr[i]);
                if (value < 0 || value >= 256) return false;
            } else {
                return false;
            }
        }
        return true;
    }

    boolean isIPv6(String str) {
        if (str.contains(".")) return false;
        String arr[] = str.split(":");
        if (arr.length != 8) return false;
        for (int i = 0; i < arr.length; i++) {
            if (arr[i].length() > 4 || arr[i].length() == 0) return false;
            if (isNumber(arr[i]) || validv6(arr[i])) continue;
            else return false;
        }
        return true;
    }

    boolean isNumber(String s) {
        int i = 0;
        while (i < s.length()) {
            if (!(s.charAt(i) >= '0' && s.charAt(i) <= '9')) return false;
            i++;
        }
        return true;
    }

    boolean validv6(String s) {
        for (int i = 0; i < s.length(); i++) {
            char curr = s.charAt(i);
            if (Character.isLetter(curr) && Character.toLowerCase(curr) >= 'a' && Character.toLowerCase(curr) <= 'f') continue;
            else if (Character.isDigit(curr)) continue;
            else return false;
        }
        return true;
    }

    public static void main(String[] args) {
        IPValidation ipValidation = new IPValidation();
        String ip = "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
        String ans = ipValidation.validIPAddress(ip);
        System.out.println("ans = " + ans);
    }
}
